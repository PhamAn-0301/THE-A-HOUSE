{{!--
Expect: rooms = [
{ id, room_name, price, district, city, image_url, icon, detail, address }
]
--}}

<section class="container" style="padding:28px 0">
    <h1 class="text-center" style="margin:0 0 18px 0; font-weight:800; letter-spacing:.5px; color:var(--navy);">
        Danh sách phòng cho thuê
    </h1>

    {{#if rooms.length}}

    <div class="room-grid">
        {{#each rooms as |r|}}
        <article class="room-card">
            <div class="thumb">
                <img src="{{r.image_url}}" alt="{{r.room_name}}">
                <span class="ribbon">Còn Phòng</span>
            </div>

            <div class="body">
                <h3 class="title">{{r.room_name}}</h3>

                <div class="price">
                    {{!-- Nếu bạn có helper formatVND thì dùng: {{formatVND r.price}} --}}
                    {{r.price}} ₫
                </div>

                <ul class="meta">
                    <li title="Khu vực">
                        <i class="bi bi-geo-alt"></i>
                        {{#if r.district}}Quận {{r.district}}, {{/if}}{{#if r.city}}{{r.city}}{{else}}Hồ Chí Minh{{/if}}
                    </li>
                    <li title="Loại phòng"><i class="bi bi-house-door"></i> Phòng dịch vụ</li>
                </ul>

                {{#if r.icon}}
                <div class="badges">
                    {{!-- đơn giản hiển thị chuỗi icon, hoặc sau này bạn tách thành từng badge --}}
                    <span class="badge">{{r.icon}}</span>
                </div>
                {{/if}}

                <div class="actions">
                    <a class="btn-outline" href="/services/{{r.id}}">Xem chi tiết</a>
                </div>
            </div>
        </article>
        {{/each}}
    </div>
    {{#if pagination}}
    <nav class="pager">
        {{#if pagination.hasPrev}}
        <a href="{{pagination.prevLink}}" class="page-btn prev">« Trang trước</a>
        {{else}}
        <span class="page-btn disabled">« Trang trước</span>
        {{/if}}
    
        <span class="page-indicator">Trang {{pagination.page}} / {{pagination.totalPages}}</span>
    
        {{#if pagination.hasNext}}
        <a href="{{pagination.nextLink}}" class="page-btn next">Trang sau »</a>
        {{else}}
        <span class="page-btn disabled">Trang sau »</span>
        {{/if}}
    </nav>
    
    <style>
        .pager {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 14px;
            margin-top: 24px;
            font-family: 'Poppins', sans-serif;
        }
    
        .page-btn {
            background: linear-gradient(135deg, #4C8EFF, #2B59C3);
            color: #fff;
            padding: 8px 18px;
            border-radius: 999px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.25s ease;
            box-shadow: 0 4px 14px rgba(43, 89, 195, 0.25);
        }
    
        .page-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(43, 89, 195, 0.4);
            opacity: 0.95;
        }
    
        .page-btn.disabled {
            background: #e5e7eb;
            color: #9ca3af;
            cursor: not-allowed;
            box-shadow: none;
        }
    
        .page-indicator {
            font-size: 15px;
            font-weight: 600;
            color: var(--navy);
        }
    
        @media (max-width: 640px) {
            .pager {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
    {{/if}}

    {{else}}
    <p class="text-center" style="margin:18px 0">Chưa có phòng nào.</p>
    {{/if}}
</section>

{{!-- Scoped styles cho grid/card – dùng biến màu & shadow từ main.css --}}
<style>
    .room-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 22px;
    }

    .room-card {
        background: #fff;
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        overflow: hidden;
        display: flex;
        flex-direction: column;
    }

    .room-card .thumb {
        position: relative;
        aspect-ratio: 16/10;
        overflow: hidden;
    }

    .room-card .thumb img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
        transition: transform .35s ease;
    }

    .room-card:hover .thumb img {
        transform: scale(1.03);
    }

    .room-card .ribbon {
        position: absolute;
        top: 10px;
        left: 10px;
        background: var(--navy);
        color: #fff;
        font-size: 12px;
        font-weight: 700;
        letter-spacing: .3px;
        padding: 6px 10px;
        border-radius: 999px;
        box-shadow: 0 6px 18px rgba(0, 0, 0, .12);
    }

    .room-card .body {
        padding: 14px 16px 18px 16px;
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .room-card .title {
        margin: 0;
        font-size: 17px;
        line-height: 1.4;
        color: #2b2b2b;
        font-weight: 600;
    }

    .room-card .price {
        font-size: 18px;
        font-weight: 800;
        color: var(--navy);
    }

    .room-card .meta {
        list-style: none;
        margin: 4px 0 0 0;
        padding: 0;
        display: grid;
        gap: 6px;
        color: #475569;
        font-size: 14px;
    }

    .room-card .meta i {
        margin-right: 6px;
    }

    .room-card .badges {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin-top: 4px;
    }

    .room-card .badge {
        display: inline-flex;
        align-items: center;
        border: 1px solid rgba(0, 0, 0, .08);
        background: #f8fafc;
        color: #334155;
        font-size: 12px;
        padding: 4px 8px;
        border-radius: 999px;
    }

    .room-card .actions {
        margin-top: 6px;
        display: flex;
        justify-content: flex-start;
    }

    .room-card .btn-outline {
        border: 1.6px solid rgba(0, 0, 0, .15);
        color: #1f2937;
    }

    @media (max-width: 980px) {
        .room-grid {
            grid-template-columns: 1fr 1fr;
        }
    }

    @media (max-width: 640px) {
        .room-grid {
            grid-template-columns: 1fr;
        }
    }
    .room-grid{
  align-items: stretch;          /* NEW */
}

/* 2) Card chiếm 100% chiều cao của ô grid */
.room-card{
  height: 100%;                  /* NEW */
  display: flex;
  flex-direction: column;
}

/* 3) Phần body nở ra hết, đẩy actions xuống đáy */
.room-card .body{
  flex: 1;                       /* NEW */
  display: flex;                 /* đảm bảo column */
  flex-direction: column;
}

/* 4) Nút luôn dính đáy */
.room-card .actions{
  margin-top: auto;              /* NEW -> đẩy xuống đáy */
  display: flex;
}

/* (khuyến nghị) Giới hạn 2 dòng tiêu đề để chiều cao đồng đều hơn */
.room-card .title {
  display: block;              /* Không cắt dòng */
  overflow: visible;           /* Cho phép hiển thị toàn bộ text */
  white-space: normal;         /* Cho phép xuống dòng tự nhiên */
  line-height: 1.5;
  font-size: 17px;
  font-weight: 700;
  color: var(--navy);
}
</style>